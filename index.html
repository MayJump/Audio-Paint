index.html
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Spicy Particle Trails — 5 to 100</title>
<style>
  :root { color-scheme: dark; }
  html, body { margin:0; height:100%; background:#0b0d10; overflow:hidden; }
  canvas { display:block; position:fixed; inset:0; }
  #msg {
    position:fixed; left:12px; bottom:12px; z-index:2;
    font:12px/1.4 system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
    color:#cbd5e1; background:#0b0d10aa; border:1px solid #1f2937; border-radius:10px;
    padding:8px 10px; backdrop-filter:blur(6px);
  }
</style>
</head>
<body>
<canvas id="scene"></canvas>
<div id="msg">+ / − = particles • R = reseed • X = clear</div>

<script>
/* ====== TUNING ====== */
let PARTICLE_COUNT = 50;        // live-adjustable: clamped to 5..100
const MIN_PARTICLES   = 5;
const MAX_PARTICLES   = 100;

const SETTINGS = {
  step: 2.0,         // longer per-frame motion
  lineWidth: 1.2,    // bolder strokes for few particles
  noiseScale: 0.0009,// tighter curls
  fieldSpeed: 0.34,  // field drift
  fadeAlpha: 0.012,  // slower fade = longer trails
  bg: "#0b0d10",
  palettes: [
    ["#A7C7E7","#6EB5FF","#6B9AC4","#E9F1FF","#C1FFD7"],
    ["#FF6B6B","#FFD93D","#6BCB77","#4D96FF","#B983FF"],
    ["#00C2FF","#00FFC6","#7CFFCB","#F7F7FF","#BDB2FF"],
    ["#F94144","#F3722C","#F8961E","#90BE6D","#577590"],
    ["#D1E8E2","#9AD1D4","#6EC5E9","#C490D1","#845EC2"]
  ]
};
/* ==================== */

const TAU = Math.PI * 2;
const canvas = document.getElementById('scene');
const ctx = canvas.getContext('2d', { alpha:false });
const msgEl = document.getElementById('msg');

let W=0, H=0, frameCount=0;
let particles = [];
let palette = pick(SETTINGS.palettes);
let seed = (Math.random()*1e9)|0;

function start(){
  resize();
  reseed();
  requestAnimationFrame(loop);
}
document.readyState === "loading" ? addEventListener('DOMContentLoaded', start) : start();

/* ---------- Core ---------- */
function reseed(){
  seed = (Math.random()*1e9)|0;
  palette = pick(SETTINGS.palettes);
  particles = new Array(PARTICLE_COUNT).fill(0).map(()=>spawn());
  hardClear();
  flashMsg(`Reseeded • Particles: ${PARTICLE_COUNT}`);
}

function spawn(){
  return {
    x: Math.random()*W,
    y: Math.random()*H,
    hue: pick(palette),
    life: 0
  };
}

function hardClear(){
  ctx.globalAlpha = 1;
  ctx.fillStyle = SETTINGS.bg;
  ctx.fillRect(0,0,W,H);
  // subtle film grain
  const n = 3000;
  ctx.globalAlpha = 0.04;
  for(let i=0;i<n;i++){
    const x = Math.random()*W, y=Math.random()*H;
    ctx.fillStyle = Math.random() < 0.5 ? "#0b0d10" : "#0c0f13";
    ctx.fillRect(x,y,1,1);
  }
  ctx.globalAlpha = 1;
}

function loop(t){
  requestAnimationFrame(loop);
  frameCount++;

  // long trails
  ctx.globalAlpha = SETTINGS.fadeAlpha;
  ctx.fillStyle = SETTINGS.bg;
  ctx.fillRect(0,0,W,H);
  ctx.globalAlpha = 1;

  // lightweight glow every other frame
  const glowOn = (frameCount % 2 === 0);
  if (glowOn) {
    ctx.shadowColor = 'rgba(255,255,255,0.10)';
    ctx.shadowBlur  = 10;
  } else {
    ctx.shadowBlur = 0;
  }

  ctx.lineWidth = SETTINGS.lineWidth;
  ctx.lineCap = 'round'; ctx.lineJoin = 'round';
  ctx.globalCompositeOperation = 'lighter';

  const z = t * 0.001 * SETTINGS.fieldSpeed;

  for (let p of particles){
    const angle = valueNoise(p.x*SETTINGS.noiseScale, p.y*SETTINGS.noiseScale, z) * TAU * 2;
    const nx = p.x + Math.cos(angle) * SETTINGS.step;
    const ny = p.y + Math.sin(angle) * SETTINGS.step;

    ctx.beginPath();
    ctx.moveTo(p.x, p.y);
    ctx.lineTo(nx, ny);
    ctx.strokeStyle = withAlpha(p.hue, 0.09 + 0.16*Math.random());
    ctx.stroke();

    p.x = nx; p.y = ny;
    p.life++;

    // wrap & refresh
    if (p.x < -10 || p.x > W+10 || p.y < -10 || p.y > H+10 || p.life > 1500){
      Object.assign(p, spawn());
    }
  }

  ctx.globalCompositeOperation = 'source-over';
}

/* ---------- Input ---------- */
addEventListener('keydown', (e)=>{
  if (e.key === '+' || e.key === '=') {
    PARTICLE_COUNT = clamp(PARTICLE_COUNT + 5, MIN_PARTICLES, MAX_PARTICLES);
    reseed();
  }
  if (e.key === '-' || e.key === '_') {
    PARTICLE_COUNT = clamp(PARTICLE_COUNT - 5, MIN_PARTICLES, MAX_PARTICLES);
    reseed();
  }
  if (e.key === 'r' || e.key === 'R') {
    reseed();
  }
  if (e.key === 'x' || e.key === 'X') {
    hardClear();
    flashMsg('Cleared');
  }
  if (e.key === 'c' || e.key === 'C') {
    palette = pick(SETTINGS.palettes);
    flashMsg('New palette');
  }
});

/* ---------- Utils ---------- */
function clamp(v,min,max){ return v<min?min:v>max?max:v; }
function pick(arr){ return arr[(Math.random()*arr.length)|0]; }
function withAlpha(hex, a){
  hex = hex.replace('#','');
  if(hex.length===3){ hex = hex.split('').map(c=>c+c).join(''); }
  const num = parseInt(hex,16);
  const r=(num>>16)&255, g=(num>>8)&255, b=num&255;
  return `rgba(${r},${g},${b},${a})`;
}
function flashMsg(text){
  msgEl.textContent = `+ / − = particles • R = reseed • X = clear  —  ${text}`;
  clearTimeout(flashMsg._t);
  flashMsg._t = setTimeout(()=>{ msgEl.textContent = '+ / − = particles • R = reseed • X = clear'; }, 1600);
}

/* ---------- Noise (seeded value-noise) ---------- */
function valueNoise(x, y, z=0){
  const xi=Math.floor(x), yi=Math.floor(y), zi=Math.floor(z);
  const xf=x-xi, yf=y-yi, zf=z-zi;
  const u=fade(xf), v=fade(yf), w=fade(zf);

  const aaa=hash3(xi,yi,zi), aab=hash3(xi,yi,zi+1);
  const aba=hash3(xi,yi+1,zi), abb=hash3(xi,yi+1,zi+1);
  const baa=hash3(xi+1,yi,zi), bab=hash3(xi+1,yi,zi+1);
  const bba=hash3(xi+1,yi+1,zi), bbb=hash3(xi+1,yi+1,zi+1);

  const x1=lerp(aaa, baa, u), x2=lerp(aba, bba, u), y1=lerp(x1, x2, v);
  const x3=lerp(aab, bab, u), x4=lerp(abb, bbb, u), y2=lerp(x3, x4, v);
  return lerp(y1, y2, w);
}
function hash3(x, y, z){
  let h = x*374761393 + y*668265263 + z*1442695041 + seed;
  h = (h ^ (h >> 13)) * 1274126177; h ^= h >> 16;
  return (h >>> 0) / 4294967295;
}
const fade = t => t*t*t*(t*(t*6-15)+10);
const lerp = (a,b,t)=>a+(b-a)*t;

/* ---------- Resize ---------- */
function resize(){
  W = Math.floor(window.innerWidth);
  H = Math.floor(window.innerHeight);
  canvas.width = W; canvas.height = H;
  hardClear();
}
addEventListener('resize', resize);
</script>
</body>
</html>
