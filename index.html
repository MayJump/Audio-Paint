index.html
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Spicy Particle Trails</title>
<style>
html, body {margin:0; padding:0; background:#000; overflow:hidden; height:100%;}
canvas {display:block;}
#msg {position:fixed; bottom:10px; left:10px; color:white; font-family:monospace; background:rgba(0,0,0,0.5); padding:4px 8px; border-radius:4px;}
</style>
</head>
<body>
<canvas id="c"></canvas>
<div id="msg">Press + or - to change particle count</div>
<script>
const W = window.innerWidth, H = window.innerHeight;
const canvas = document.getElementById('c');
canvas.width = W; canvas.height = H;
const ctx = canvas.getContext('2d');

const SETTINGS = {
  density: 0.0006,
  step: 2.0,
  lineWidth: 1.2,
  noiseScale: 0.0009,
  fieldSpeed: 0.34,
  fadeAlpha: 0.012,
  bg: "#0b0d10",
  palettes: [
    ["#A7C7E7","#6EB5FF","#6B9AC4","#E9F1FF","#C1FFD7"],
    ["#FF6B6B","#FFD93D","#6BCB77","#4D96FF","#B983FF"],
    ["#00C2FF","#00FFC6","#7CFFCB","#F7F7FF","#BDB2FF"],
    ["#F94144","#F3722C","#F8961E","#90BE6D","#577590"],
    ["#D1E8E2","#9AD1D4","#6EC5E9","#C490D1","#845EC2"]
  ]
};

const SUBSTEPS = 1;
const MAX_PARTICLES = 3000;
let palette = SETTINGS.palettes[0];
let particles = [];
let frameCount = 0;
let audio = { level: 0, enabled: false, fallback: true };

function msg(txt) {
  document.getElementById('msg').innerText = txt;
}

function pick(arr) {return arr[Math.floor(Math.random()*arr.length)];}
function withAlpha(hex, alpha){
  const c = parseInt(hex.slice(1), 16);
  const r = (c >> 16) & 255;
  const g = (c >> 8) & 255;
  const b = c & 255;
  return `rgba(${r},${g},${b},${alpha})`;
}

function reseed(){
  const base = Math.max(200, Math.floor(W*H*SETTINGS.density));
  const count = Math.min(MAX_PARTICLES, base);
  particles = new Array(count).fill(0).map(() => ({
    x: Math.random()*W, 
    y: Math.random()*H, 
    hue: pick(palette), 
    life: 0
  }));
}

function fade(){
  ctx.fillStyle = SETTINGS.bg;
  ctx.globalAlpha = SETTINGS.fadeAlpha;
  ctx.fillRect(0, 0, W, H);
  ctx.globalAlpha = 1;
}

function loop(t){
  requestAnimationFrame(loop);
  fade();
  frameCount++;

  const glowOn = (frameCount % 2 === 0);
  if (glowOn) {
    ctx.shadowColor = 'rgba(255,255,255,0.10)';
    ctx.shadowBlur  = 6 + audio.level * 14;
  } else {
    ctx.shadowBlur = 0;
  }

  ctx.lineWidth = SETTINGS.lineWidth;
  ctx.globalCompositeOperation = 'lighter';

  for (let p of particles) {
    for (let s = 0; s < SUBSTEPS; s++) {
      const angle = noise(p.x * SETTINGS.noiseScale, p.y * SETTINGS.noiseScale, t*SETTINGS.fieldSpeed*0.001) * Math.PI*2;
      const nx = p.x + Math.cos(angle) * SETTINGS.step;
      const ny = p.y + Math.sin(angle) * SETTINGS.step;
      ctx.beginPath();
      ctx.moveTo(p.x, p.y);
      ctx.lineTo(nx, ny);
      ctx.strokeStyle = withAlpha(p.hue, 0.08 + 0.16 * Math.random());
      ctx.stroke();
      p.x = nx; p.y = ny;
    }
    p.life++;
    if (p.x < -10 || p.x > W+10 || p.y < -10 || p.y > H+10 || p.life > 1500) {
      p.x = Math.random()*W; p.y = Math.random()*H; p.hue = pick(palette); p.life = 0;
    }
  }
  ctx.globalCompositeOperation = 'source-over';
}

window.addEventListener('keydown', e => {
  if (e.key === '+') {
    SETTINGS.density = Math.min(SETTINGS.density + 0.0002, 0.005);
    reseed();
    msg(`Particles: ${particles.length}`);
  }
  if (e.key === '-') {
    SETTINGS.density = Math.max(SETTINGS.density - 0.0002, 0.0001);
    reseed();
    msg(`Particles: ${particles.length}`);
  }
});

function noise(x, y, z){
  return (Math.sin(x*12.9898 + y*78.233 + z*37.719) * 43758.5453) % 1;
}

reseed();
loop();
</script>
</body>
</html>
